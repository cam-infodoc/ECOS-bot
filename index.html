<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>BotECOS</title>
<style>
body {
  font-family: system-ui;
  background: #f0f0f0;
  display: flex;
  justify-content: center;
  padding: 20px;
}

.chat-container {
  background: white;
  width: 360px;
  height: 600px;
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.messages {
  flex: 1;
  padding: 10px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* ===== BOT AVEC AVATAR ===== */
.bot-container {
  display: flex;
  align-items: flex-start;
  gap: 8px;
}

.bot-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: #fff;
  border: 1px solid #ccc;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  flex-shrink: 0;
}

.bot {
  background: #E5E5EA;
  padding: 10px 14px;
  border-radius: 18px 18px 18px 4px;
  max-width: 75%;
  white-space: pre-wrap;
}

.thinking {
  font-style: italic;
  opacity: 0.7;
}

/* ===== USER ===== */
.user {
  align-self: flex-end;
  background: #0084FF;
  color: white;
  padding: 10px 14px;
  border-radius: 18px 18px 4px 18px;
  max-width: 75%;
}

.input-area {
  display: flex;
  border-top: 1px solid #ddd;
}

input {
  flex: 1;
  border: none;
  padding: 12px;
  font-size: 14px;
}

button {
  border: none;
  padding: 12px;
  background: #0084FF;
  color: white;
  cursor: pointer;
}

#finishBtn {
  background: #ff5c7b;
  margin-left: 4px;
}

/* ===== CHOICES ===== */
.choices {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
}

.choices button {
  width: calc(50% - 4px);
  padding: 12px;
  background: #0084FF;
  color: white;
  font-weight: bold;
  border-radius: 12px;
  border: none;
  cursor: pointer;
}
</style>
</head>
<body>

<div class="chat-container">
  <div class="messages" id="messages"></div>
  <div class="input-area">
    <input id="input" placeholder="√âcris ta question‚Ä¶">
    <button onclick="send()">‚û§</button>
    <button id="finishBtn" onclick="calculateScore()" disabled>üèÅ Terminer</button>
  </div>
</div>

<script>
// ===== DATA =====
const data = {
  themes: [
    {
      id: "HGE",
      title: "H√©pato-gastro-ent√©rologie",
      chapters: [
        {
          id: "SDD1",
          title: "Constipation",
          intro: "Vous √™tes gastro-ent√©rologue et vous recevez Mme Dubois, 31 ans, pour une constipation chronique.",
          recap: [
            "Il faut bien diff√©rencier constipation fonctionnelle et organique.",
            "La constipation fonctionnelle ou idiopathique est soit de transit (r√©duction de la fr√©quence ou de l'amplitude des contractions coliques) soit distale (=dysch√©sie, expliqu√©e par un trouble fonctionnel ou anatomique de la statique pelvienne).",
            "La constipation fonctionnelle donne des petites selles dures et peu nombreuses dans la semaine, il faut d'ailleurs chercher une colopathie fonctionnelle.",
            "La constipation distale donne des efforts de pouss√©es importants avec une sensation d'√©vacuation incompl√®te et souvent des manoeuvres distales pour favoriser l'√©vacuation.",
            "Les signes d'alarmes auraient √©t√© une AEG, un amaigrissement, des douleurs nocturnes ou insomniantes, des rectorragies / m√©l√©na ou un syndrome rectal (√©preinte, t√©nesme, faux besoins). Face √† ces signes d'alarme on pense √† une constipation organique ou secondaire et il faut √©liminer le syndrome occlusif.",
            "Pour les examens compl√©mentaires, aucun n'est n√©cessaire chez un constip√© chronique sans signe d'alarme. Un bilan sanguin est possible mais pas obligatoire (NFS, CRP, TSH, ionogramme sanguin, calc√©mie, glyc√©mie, cr√©at).",
            "Si les sympt√¥mes apparaissent apr√®s 50 ans on pense forc√©ment √† prescrire une coloscopie."
          ],

          questionSet: [
            { "id": "q_constip_1", "patterns":["√©volution","combien de temps","combien de jours"], "answer":"Je suis constip√©e depuis environ 4 ans, sans aggravation particuli√®re. Et je fais moins de 3 selles par semaine." },
            { "id": "q_constip_2", "patterns":["alt√©ration √©tat g√©n√©ral","amaigrissement","perte de poids", "poids", "plus fatigu√©e"], "answer":"Je n'ai pas perdu de poids et je me sens pas plus fatigu√©e qu'avant Docteur." },
            { "id": "q_constip_3", "patterns":["douleurs nocturnes","douleur la nuit","douleur insomniante", "vous emp√™che de dormir", "nuit", "douleur"], "answer":"Ma douleur abdominale ne m'emp√™che pas de bien dormir la nuit. Je dirais que c'est une douleur comme des spasmes." },
            { "id": "q_constip_4", "patterns":["rectorragies","rectorragie","m√©l√©na", "sang dans les selles", "sang"], "answer":"Oula vous me faites peur Docteur, non non il n'y a pas de sang dans mes selles. On va faire une imagerie du coup Docteur ?" },
            { "id": "q_constip_5", "patterns":["contractions abdominales avant la selle","√©preintes","t√©nesme", "faux besoins", "glaires"], "answer":"Non je n'ai aucun signe de syndrome rectal." },
            { "id": "q_constip_6", "patterns":["comment sont vos selles", "dures","petites","moins de selles par semaine", "moins souvent"], "answer":"C'est vrai que je vais moins √† la selle qu'avant, environ 3 fois par semaine. D'ailleurs mes selles sont petites et tr√®s dures Docteur. Je bois beaucoup d'eau et je fais de la corde √† sauter pour m'aider, √ßa marche pas trop..." },
            { "id": "q_constip_7", "patterns":["efforts de pouss√©e","vous devez pousser","incomplet", "reste encore des selles", "manoeuvres digitales", "√©vacuation des selles √† la main"], "answer":"Ah non non je fais caca normalement. Je pousse m√™me moins qu'avant √† vrai dire, mais quand je suis all√©e √† la selle c'est fini." },
            { "id": "q_constip_8", "patterns":["gaz","naus√©es","vomissements", "vomi", "vomis"], "answer":"J'ai toujours des gaz, et non je n'ai jamais vomi ni vraiment eu de naus√©es." },
            { "id": "q_constip_9", "patterns":["examens compl√©mentaires","imagerie","scanner", "radiographie"], "answer":"Je vous fais confiance en terme d'imagerie." },
            { "id": "q_constip_10", "patterns":["fibre","r√®gles hygi√©no-di√©t√©tiques","mesures hygi√©no-di√©t√©tiques"], "answer":"Ok Docteur je ferai ce que vous me pr√©conisez." },
            { "id": "q_constip_11", "patterns":["laxatifs","m√©dicaments","m√©dicament", "laxatifs osmotiques", "laxatifs de lest"], "answer":"D'accord Docteur si √ßa peut m'aider je vous √©coute !" },
            { "id": "q_constip_12", "patterns":["ant√©c√©dents m√©dicaux","ant√©c√©dents", "ant√©c√©dents personnels"], "answer":"J'ai eu 2 grossesses avec accouchement par voie basse, la derni√®re il y a un an, et j'ai √©t√© op√©r√©e de l'appendicite." },
            { "id": "q_constip_13", "patterns":["ant√©c√©dents familiaux","famille"], "answer":"Dans ma famille je sais juste que ma tante a eu un cancer de l'ovaire, c'est tout." },
            { "id": "q_constip_14", "patterns":["bonjour"], "answer":"Bonjour, je suis bien Madame Dubois, je vous consulte Docteur car je suis constip√©e." },
            { "id": "q_constip_15", "patterns":["compris", "clair", "autres questions", "questions"], "answer":"Tout est clair pour moi Docteur, merci pour tout bonne journ√©e." },
          ]
        },

        {
          id: "SDD2",
          title: "Diarrh√©e",
          intro: "Vous √™tes gastro-ent√©rologue et vous recevez Mr ROUX, 60 ans, qui se plaint d'une diarrh√©e depuis 4 jours. Cherchez √† l'interrogatoire et √† l'examen clinique les signes orientant le diagnostic √©tiologique. Recherchez les complications de la diarrh√©e.",
          recap: [
            "Il faut savoir identifier le syndrome chol√©riforme et les syndromes invasifs.",
            "Un syndrome chol√©riforme est un trouble de la fonction s√©cr√©toire. Il donne des diarrh√©es profuses af√©cales, on retrouve des signes de d√©shydratation et il n'y a pas de fi√®vre.",
            "Les syndromes invasifs comprennent le syndrome dysent√©rique et le syndrome gastro-ent√©rique.",
            "Le syndrome dysent√©rique signe l'invasion des cellules √©pith√©liales. Il donne du sang, des glaires voire du pus et un syndrome rectal est fr√©quent. Les douleurs abdominales sont diffuses ou colique et on retrouve de la fi√®vre.",
            "Le syndrome gastro-ent√©rique est bact√©rien. Il donne une diarrh√©e asp√©cifique souvent avec naus√©es, vomissement, fi√®vre et syndrome pseudo-grippal."
          ],

          questionSet: [
            { "id": "q_dia_1", "patterns":["ant√©c√©dents","ant√©c√©dents personnels"], "answer":"Je n'ai pas d'ant√©c√©dents particuliers." },
            { "id": "q_dia_2", "patterns":["alcool","tabac","fumez", "buvez", "alcoolo-tabagique"], "answer":"Je ne fume pas, je ne bois pas." },
            { "id": "q_dia_3", "patterns":["voyage","voyag√©","contage", "zone d'end√©mie", "avion"], "answer":"Je n'ai pas voyag√© r√©cemment non. Puis dans ma famille je suis le seul √† √™tre malade." },
            { "id": "q_dia_4", "patterns":["antibiotiques","traitement","traitements"], "answer":"Je n'ai aucun traitement habituellement et r√©cemment je n'ai rien pris de particulier." },
            { "id": "q_dia_5", "patterns":["liquide","sang","glaires", "selles", "d√©crivez moi vos selles"], "answer":"Depuis 4 jours j'ai des diarrh√©es, parfois je trouve m√™me du sang voir des glaires." },
            { "id": "q_dia_6", "patterns":["faux besoins", "tension anale","douleur avant les selles","spasmes", "√©preintes"], "answer":"J'ai des douleurs √† type de spasmes avant de faire caca maintenant que vous me le demandez c'est vrai !" },
            { "id": "q_dia_7", "patterns":["constipation","douleur","douleurs", "naus√©es", "vomissement", "vomi"], "answer":"J'ai des douleurs √† type de spasmes avant les selles mais c'est tout." },
            { "id": "q_dia_8", "patterns":["constantes","tension","fr√©quence cardiaque", "temp√©rature"], "answer":"Ma tension est √† 120/70 mmHg. Ma FC √† 110 bpm. Ma temp√©rature √† 36,5¬∞C et je n'ai pas pris de doliprane avant de venir." },
            { "id": "q_dia_9", "patterns":["soif","s√©cheresse","muqueuses", "trouble conscience"], "answer":"Mes muqueuses sont s√®ches." },
            { "id": "q_dia_10", "patterns":["pli cutan√©","cernes","tachycardie", "hypotension", "oligurie", "perte de poids", "poids", "veines jugulaires"], "answer":"Mes veines jugulaires sont plates et j'ai perdu 3 kg depuis le d√©but de mes diarrh√©es." },
            { "id": "q_dia_11", "patterns":["fi√®vre","frissons"], "answer":"Je ne crois pas avoir eu de fi√®vre √† la maison, en tout cas je n'ai jamais frisson√©. Actuellement je ne frissonne pas d'ailleurs." },
            { "id": "q_dia_12", "patterns":["allergie","allergies"], "answer":"Je n'ai aucune allergie." },
            { "id": "q_dia_13", "patterns":["toxiques","alcool", "tabac", "fumez"], "answer":"Je ne fume pas, je ne bois pas Docteur !" },
            { "id": "q_dia_14", "patterns":["bonjour"], "answer":"Bonjour, je suis bien Monsieur Roux, je vous consulte Docteur car j'ai des diarrh√©es." },
            { "id": "q_dia_15", "patterns":["compris", "clair", "autres questions", "questions"], "answer":"Tout est clair pour moi Docteur, merci pour tout bonne journ√©e." },
          ]
        },
        
        {
          id: "SDD3",
          title: "Douleur abdominale",
          intro: "Vous √™tes m√©decin aux urgences et vous recevez √† 14h Mr JEAN, un patient de 60 ans amen√© aux urgences par les SP pour d'importantes douleurs abdominales. A l'interrogatoire vous notez qu'il n'a pour seul ant√©c√©dent qu'une constipation chronique, qu'il a d√©but√© des AINS il y a 2 jours pour des douleurs abdominales situ√©es en bas √† gauche du ventre, que depuis ce matin les douleurs sont plus violentes et diffuses c√¥t√©es √† 8/10 et qu'il n'a pas d'arr√™t des gaz et mati√®res. Vous √™tes accompagn√© de votre infirmier Cl√©ment. Examinez le patient et √©valuez le degr√© d'urgence de la situation. Expliquez la prise en charge dans les prochaines heures √† Mr JEAN.",
          recap: [
            "Pour les ECOS il y a plusieurs pathologies responsables de douleur abdominale √† conna√Ætre.",
            "La colique h√©patique : irradiation √† l'√©paule droite ou interscapulaire. La pancr√©atite aigue : irradiation dorsale. L'appendicite aigue : d√©but en ombilical / √©pigastre puis localisation en FID. L'ulc√®re gastrique : post-prandial tardif. La strangulation : brutal puis localisation diffuse. La colique n√©phr√©tique : irradiation vers les OGE.",
            "Il faut bien diff√©rencier la douleur fonctionnelle et organique.",
            "La douleur fonctionnelle est chronique, survient >= 1 fois par semaine, √† type de spasme, surtout en FI ou hypogastre, matinale ou post-prandiale, absente la nuite, soulag√©e par les gaz et/ou selles, augment√©e par le stress, calm√©e par le repos.",
            "La douleur organique est aigue ou chronique, pr√©sente la nuit. La s√©miologie de la douleur ou signes associ√©s orientent vers une pathologie.",
            "Attention l'intensit√© de la douleur en elle m√™me n'est pas discriminante !"
          ],

          questionSet: [
            { "id": "q_dlabdo_1", "patterns":["marbrures","TRC", "temps de recoloration cutan√©e", "froideur extr√©mit√©s"], "answer":"Pas de marbrures, extr√©mit√©s chaudes, TRC √† 2 secondes." },
            { "id": "q_dlabdo_2", "patterns":["confusion","fr√©quence respiratoire","FR", "tension", "sepsis", "qSOFA", "sofa"], "answer":"C'est not√© !" },
            { "id": "q_dlabdo_3", "patterns":["palpation abdominale","contracture","d√©fense", "hernie"], "answer":"Vous retrouvez une contracture g√©n√©ralis√©e de l'abdomen." },
            { "id": "q_dlabdo_4", "patterns":["inspection","inspection abdominale"], "answer":"Absence de cicatrices au niveau abdominal. Rien √† signaler √† l'inspection." },
            { "id": "q_dlabdo_5", "patterns":["perfusion","perfuser","perfus√©", "solut√© d'hydratation", "cristallo√Ødes"], "answer":"Cl√©ment va donc perfuser Mr JEAN." },
            { "id": "q_dlabdo_6", "patterns":["infection", "colite"], "answer":"Le patient va √™tre inform√© de votre suspicion d'infection abdominale." },
            { "id": "q_dlabdo_7", "patterns":["bilan biologique","bilan","h√©mocultures", "h√©moc"], "answer":"Un bilan sanguin sera pr√©lev√© par Cl√©ment, √©galement il piquera des h√©mocultures." },
            { "id": "q_dlabdo_8", "patterns":["constantes","tension","fr√©quence cardiaque", "temp√©rature", "glasgow"], "answer":"TA √† 95/70mmg, FC √† 110 bpm, sat √† 100% en AA, FR √† 24. Temp√©rature √† 39¬∞C. Score de Glasgow √† 15." },
            { "id": "q_dlabdo_9", "patterns":["scanner","scanner abdominal","scanner AP"], "answer":"Le patient est inform√© qu'il r√©alisera un scanner abdominal." },
            { "id": "q_dlabdo_10", "patterns":["op√©ration","chirurgie","chirurgien"], "answer":"Le patient est inform√© de la possibilit√© d'une chirurgie en urgence apr√®s le bilan diagnostique." },
            { "id": "q_dlabdo_11", "patterns":["anesth√©sie g√©n√©rale","unit√© soins intensifs"], "answer":"Le patient est inform√© qu'il sera op√©r√© sous AG et qu'il sera hospitalis√© en unit√© de soins intensifs." },
            { "id": "q_dlabdo_12", "patterns":["bonjour"], "answer":"Monsieur JEAN vous r√©pond avec un visage crisp√© bonjour." }
          ]
        },
    
        {
          id: "SDD4",
          title: "Douleur anale",
          intro: "Vous √™tes proctologue et recevez en consultation Mme MOREAU, patiente de 40 ans, qui se plaint de douleurs anales depuis 4 jours. Vous devez mener un interrogatoire afin de caract√©riser la douleur et d'orienter votre diagnostic, r√©aliser un examen proctologique et indiquer votre principale hypoth√®se diagnostique.",
          recap: [
            "Pour les ECOS il faut savoir caract√©riser une douleur, on demande : localisation, intensit√©, type, horaire, irradiation, facteurs aggravants ou am√©liorants, signes associ√©s, √©volution.",
            "La douleur anale apr√®s la selle doit vous √©voquer : crise h√©morro√Ødaire (douleur pendant quelques minutes d√©clench√©e par la selle, +/- saignements, dure quelques jours), fissure anale (douleur quelques minutes apr√®s la selle puis r√©cidive de la douleur des heures apr√®s la selle, +/- saignements, dure des semaines).",
            "La douleur anale avant la selle doit vous √©voquer : f√©calome, cancer du rectum. Les deux par syndrome rectal (t√©nesme, √©preintes, √©missions glairo sanglantes af√©cales).",
            "La douleur anale ind√©pendante de la selle doit vous √©voquer : thrombose h√©morro√Ødaire externe (tum√©faction bleue limit√©e, douleur au toucher et √† la position assise, d√©gressive sur quelques heures √† quelques jours), abc√®s anal (tum√©faction mal limit√©e, douleur au toucher et assise, continue sur quelques heures / jours)."
          ],

          questionSet: [
            { "id": "q_dlanale_1", "patterns":["type de douleur","douleur", "d√©crire votre douleur"], "answer":"La douleur c'est comme des br√ªlures depuis 4 jours." },
            { "id": "q_dlanale_2", "patterns":["intensit√© douleur","retentissement","c√¥ter", "EVA"], "answer":"La douleur est assez forte et me d√©range √©norm√©ment pendant la d√©f√©cation, ensuite elle disparait." },
            { "id": "q_dlanale_3", "patterns":["horaire","matin","journ√©e", "soir"], "answer":"La douleur se limite vraiment au moment des selles. Sinon c'est g√©nant mais √ßa va." },
            { "id": "q_dlanale_4", "patterns":["√©volution","√©volu", "√©volue"], "answer":"C'est la 4e fois que √ßa arrive. Tous apr√®s mon 2e accouchement il y a 3 mois." },
            { "id": "q_dlanale_5", "patterns":["aggravant","aggravants","d√©clenchants", "d√©clenchant"], "answer":"La douleur est d√©clench√©e par les selles et calm√©e imm√©diatement apr√®s." },
            { "id": "q_dlanale_6", "patterns":["suintement", "saignement", "sang"], "answer":"Non il n'y a pas de saignements ni de suintement." },
            { "id": "q_dlanale_7", "patterns":["constipation","diarrh√©e","diarrh√©es", "transit"], "answer":"J'ai tendance √† √™tre constip√©e de nature c'est vrai √ßa. Mais l√† c'est diff√©rent." },
            { "id": "q_dlanale_8", "patterns":["ant√©c√©dents","ant√©c√©dents gyn√©cologiques","gyn√©co"], "answer":"J'ai eu 2 enfants ! Le dernier il y a trois mois et le premier il y a 3 ans. Tous par voie basse, pas de complications." },
            { "id": "q_dlanale_9", "patterns":["temp√©rature","frissons","fi√®vre"], "answer":"Non j'ai pas eu de fi√®vre associ√©e." },
            { "id": "q_dlanale_10", "patterns":["position","g√©nupectorale","genupectorale"], "answer":"D'accord je vais me mettre en position genupectorale Docteur." },
            { "id": "q_dlanale_11", "patterns":["inspection","prolapsus", "fissure anale"], "answer":"L'inspection anale ne retrouve ni prolapsus, ni fissure anale, ni h√©morro√Ødes externes." },
            { "id": "q_dlanale_12", "patterns":["bonjour"], "answer":"Bonjour Docteur, je suis bien Mme MOREAU. Je viens pour des douleurs anales." },
            { "id": "q_dlanale_13", "patterns":["anuscope", "anuscopie"], "answer":"A l'anuscopie vous retrouvez un prolapsus h√©morro√Ødaire interne." },
            { "id": "q_dlanale_14", "patterns":["diagnostic", "hypoth√®se diagnostique", "crise h√©morro√Ødiaire"], "answer":"Votre diagnostic est retenu." }
          ]
        },

        {
          id: "SDD5",
          title: "H√©patom√©galie",
          intro: "Vous √™tes gastro-ent√©rologue et vous recevez Mr BERNARD, 54 ans, qui vous est adress√© par son m√©decin traitant. Il vous fournit la lettre suivante : Cher / Ch√®re confr√®re / consoeur, je vous adresse Mr BERNARD √¢g√© de 54 ans, √† qui j'ai d√©couvert √† l'examen clinique une h√©patom√©galie √† l'occasion d'une consultation de suivi de son HTA. Je lui ai prescrit un bilan h√©patique complet, qui retrouve des arguments en faveur d'une pathologie h√©patique chronique. Je sollicite votre expertise pour la PEC diagnostique et th√©rapeutique de notre patient. Confraternellement. Recherchez √† l'interrogatoire et √† l'examen clinique les √©l√©ments pour orienter l'enqu√™te √©tiologique et proposer un examen compl√©mentaire de 1e intention.",
          recap: [
            "Face √† une h√©patom√©galie il faut rechercher des signes d'h√©patite virale chronique, des signes de cancer, un syndrome septique, des signes d'insuffisance h√©patocellulaire chronique, des signes d'hypertension portale et de cholestase.",
            "Pour l'h√©patite virale chronique on demande : voyage en zone d'end√©mie, toxicomanie IV et rapports sexuels non prot√©g√©s.",
            "Pour l'IHC on demande : angiomes stellaires, leuconychies, hippocratisme digital, hypogonadisme, ict√®re, √©rythrose palmaire.",
            "Pour une hypertension portale on demande : ascite, spl√©nom√©galie, circulation collat√©rale",
            "Pour une cholestase on demande : ict√®re, prurit, selles d√©color√©es et urines fonc√©es."
          ],

          questionSet: [
            { "id": "q_hepatomeg_1", "patterns":["ant√©c√©dents", "ant√©c√©dents familiaux"], "answer":"Moi je suis suivi pour une hypertension et une hypercholest√©rol√©mie. Mais je sais que mon p√®re avait une cirrhose et c'est un cancer du foie qui l'a tu√©..." },
            { "id": "q_hepatomeg_2", "patterns":["consommation","alcool","tabac", "fumez", "buvez", "alcoolo-tabagique"], "answer":"Je n'ai jamais fum√© ! Par contre, bon c'est vrai que je ne me refuse jamais mes petits verres de vin... J'en bois, quoi, allez, 3 verres par jour pas plus Docteur !" },
            { "id": "q_hepatomeg_3", "patterns":["ob√©sit√©", "hypertension", "dyslipid√©mie", "cholest√©rol", "hyperglyc√©mie", "diab√®te"], "answer":"J'ai de la tension et du cholest√©rol. Pour le reste non." },
            { "id": "q_hepatomeg_4", "patterns":["voyage","zone d'end√©mie", "toxicomanie", "drogues", "rapports sexuels", "sexe"], "answer":"Je n'ai jamais pris de drogue moi alors me piquer ? Certainement pas √ßa va pas ? Puis moi j'ai jamais √©t√© un grand f√©tard alors des relations sexuelles non prot√©g√©es tr√®s peu pour moi. Par contre oui on est partis au Moyen Orient il y a 6 mois, c'√©tait pas mal." },
            { "id": "q_hepatomeg_5", "patterns":["asth√©nie", "fatigue", "perte de poids", "amaigrissement"], "answer":"Je suis pas plus fatigu√© que d'habitude et je n'ai pas perdu de poids." },
            { "id": "q_hepatomeg_6", "patterns":["aires ganglionnaires", "ganglions", "ganglion", "Troisier", "pelviens", "pelvien"], "answer":"Aucun ganglion, absence de ganglion de Troisier." },
            { "id": "q_hepatomeg_7", "patterns":["fi√®vre", "frissons", "frisson", "sepsis"], "answer":"Absence de fi√®vre, absence de frissons." },
            { "id": "q_hepatomeg_8", "patterns":["angiomes stellaires", "inspection abdominale", "angiome stellaire", "leuconychie", "leuconychies", "hippocratisme digital", "hypogonadisme", "ict√®re", "√©rythrose palmaire"], "answer":"Pr√©sence d'un hippocratisme digital, des angiomes stellaires et un ict√®re conjonctival." },
            { "id": "q_hepatomeg_9", "patterns":["ascite", "spl√©nom√©galie", "circulation collat√©rale"], "answer":"Absence d'ascite, spl√©nom√©galie ou circulation collat√©rale." },
            { "id": "q_hepatomeg_10", "patterns":["ict√®re","prurit","selles d√©color√©es", "urines fonc√©es"], "answer":"Absence d'un syndrome de cholestase." },
            { "id": "q_hepatomeg_11", "patterns":["palpation abdominale", "bord tranchant"], "answer":"Absence de bord tranchant du foie √† la palpation abdominale." },
            { "id": "q_hepatomeg_12", "patterns":["bonjour"], "answer":"Bonjour Docteur, je suis bien Mr BERNARD. Je viens car mon m√©decin g√©n√©raliste m'a envoy√© vers vous." },
            { "id": "q_hepatomeg_13", "patterns":["√©chographie", "√©cho-doppler", "√©cho", "√©cho-Doppler"], "answer":"Nous retenons l'indication d'une √©chographie abdominale." }
          ]
        },

        {
          id: "SDD6",
          title: "Incontinence f√©cale",
          intro: "Vous √™tes m√©decin g√©n√©raliste et vous recevez Mr DUPONT, 40 ans, qui vous consulte pour une perte involontaire de selles. Interrogez le patient pour caract√©riser sa plainte et avancer sur la d√©marche √©tiologique, menez un examen clinique, √©noncez votre principale hypoth√®se.",
          recap: [
            "L'incontinence f√©cale peut survenir dans les situations suivantes",
            "En p√©riode de post-partum : au m√™me titre qu'une incontinence urinaire suite √† des l√©sions p√©rin√©ales lors du travail et qui indique une r√©√©ducation p√©rin√©ale.",
            "Apr√®s des ann√©es d'√©volution d'une constipation de type terminale.",
            "A la suite d'une my√©lite dans le cadre d'une SEP.",
            "Lors d'un syndrome de la queue de cheval o√π les incontinences urinaires et f√©cales sont pr√©coces √† l'inverse de la compression m√©dullaire.",
            "Dans le cadre d'une neuropathie par dysautonomie (diab√®te++)."
          ],

          questionSet: [
            { "id": "q_incfec_1", "patterns":["depuis quand", "combien de temps", "√©pisode"], "answer":"Depuis 2 jours j'ai des selles involontaires de jour comme de nuit... C'est bien la premi√®re fois que √ßa m'arrive."},
            { "id": "q_incfec_2", "patterns":["constipation","constipation chronique"], "answer":"Non je ne suis pas particuli√®rement constip√©." },
            { "id": "q_incfec_3", "patterns":["diarrh√©e", "√©pisode de diarrh√©e", "transit", "selles"], "answer":"Je n'ai pas eu de diarrh√©es non plus en fait mes selles sont normales... je  ne les sens juste pas arriver comme avant?" },
            { "id": "q_incfec_4", "patterns":["dysurie", "urgenturie", "incontinence urinaire", "urines", "pipi"], "answer":"Oui j'ai du mal √† uriner Docteur. J'ai l'impression que mon jet est faible et pareil je sens pas bien quand je vais uriner. Pour √™tre honn√™te j'ai aussi eu quelques fuites d'urines. Puis alors niveau √©rection, c'est pas la f√™te... √ßa tient pas longtemps quoi..." },
            { "id": "q_incfec_5", "patterns":["douleur rachidienne", "mal au dos"], "answer":"Oui j'ai mal au dos depuis quelques mois. Ca irradie dans mes jambes et l√† r√©cemment depuis 3 jours √ßa c'est franchement aggrav√©." },
            { "id": "q_incfec_6", "patterns":["imagerie", "chute", "port de charges lourdes"], "answer":"Oui j'ai port√© des charges lourdes." },
            { "id": "q_incfec_7", "patterns":["hypoesth√©sie", "paresth√©sies", "sentez moins bien", "fourmis", "fourmillements", "fourmillement"], "answer":"Oui j'ai l'impression au niveau des jambes de sentir un peu moins bien." },
            { "id": "q_incfec_8", "patterns":["examen moteur", "psoas", "quadriceps", "tibial ant√©rieur", "triceps sural", "fl√©chisseurs des orteils", "extenseurs des orteils", "ischio-jambiers", "ischiojambiers"], "answer":"Les muscles tibio-ant√©rieurs, extenseurs des orteils, fl√©chisseurs des orteils et triceps suraux sont c√¥t√©s √† 3/5." },
            { "id": "q_incfec_9", "patterns":["examen sensitif", "sensibilit√©"], "answer":"Trouble sensitif post√©rolat√©ral des 2 membres inf√©rieurs." },
            { "id": "q_incfec_10", "patterns":["ROT","r√©flexes ost√©o-tendineux","ROT rotuliens", "ROT achil√©ens"], "answer":"ROT achil√©ens absents des deus c√¥t√©s." },
            { "id": "q_incfec_11", "patterns":["r√©flexe bulbo-caverneux"], "answer":"R√©flexe bulbo-caverneux aboli." },
            { "id": "q_incfec_12", "patterns":["bonjour"], "answer":"Bonjour Docteur, je suis bien Mr DUPONT. Je viens car j'ai eu un √©pisode d'incontinence f√©cale et √† mon √¢ge √ßa m'inqui√®te pas mal..." },
            { "id": "q_incfec_13", "patterns":["toucher rectal", "sensibilit√© p√©rin√©ale"], "answer":"Perte du tonus et de la contraction volontaire du sphincter anal au TR." },
            { "id": "q_incfec_14", "patterns":["raideur rachidienne", "raideur rachis", "raideur"], "answer":"Ce sont surtout les douleurs le probl√®me." },
            { "id": "q_incfec_15", "patterns":["signe de la sonnette", "signe de Las√®gue", "signe de L√©ri"], "answer":"Absence de signe de la sonnette, signe de Las√®gue ou signe de L√©ri." },
            { "id": "q_incfec_16", "patterns":["syndrome de la queue de cheval", "queue de cheval"], "answer":"Hypoth√®se diagnostique confirm√©e." },
            { "id": "q_incfec_17", "patterns":["ant√©c√©dents", "traitement", "traitements", "allergie"], "answer":"Aucun ant√©c√©dent, aucun traitement et pas d'allergies, habituellement tout va bien." },
          ]
        },

        {
          id: "SDD7",
          title: "Masse abdominale",
          intro: "Un patient de 55 ans consulte car il sent une boule dans son estomac. Compl√©tez l'anamn√®se et l'interrogatoire et d√©crivez votre examen physique abdominal.",
          recap: [
            "Devant une masse abdominale il faut toujours rechercher les signes en faveur d'une origine canc√©reuse.",
            "L'examen de la d√©marche diagnostique serait le scanner AP.",
            "Pour l'examen clinique ne pas oublier Inspection Palpation Auscultation Percussion.",
            "Ici l'hypoth√®se diagnostique serait un cancer de la t√™te du pancr√©as avec possible compression des voies biliaires."
          ],

          questionSet: [
            { "id": "q_masseabdo_1", "patterns":["contexte", "d√©couvert", "rendu compte"], "answer":"Ca fait quelques semaines que j'ai cette boule au niveau de l'estomac."},
            { "id": "q_masseabdo_2", "patterns":["ant√©c√©dents m√©dicaux", "ant√©c√©dents"], "answer":"J'ai pas d'ant√©c√©dents ni de traitements ni d'allergies." },
            { "id": "q_masseabdo_3", "patterns":["ant√©c√©dents chirurgicaux", "chirurgie"], "answer":"Je n'ai jamais √©t√© op√©r√©." },
            { "id": "q_masseabdo_4", "patterns":["ant√©c√©dants familiaux", "famille"], "answer":"Il n'y a pas d'ant√©c√©dents familiaux particuliers √† ce que je sache." },
            { "id": "q_masseabdo_5", "patterns":["transit", "naus√©es", "vomissements", "vomis"], "answer":"Ah oui docteur j'ai beaucoup de naus√©es, je mange vachement moins aussi et j'ai perdu du poids. Je saurais pas vous dire combien mais assez pour que je le remarque." },
            { "id": "q_masseabdo_6", "patterns":["signes urinaires", "urines", "pipi"], "answer":"Non √† ce niveau l√† √ßa va." },
            { "id": "q_masseabdo_7", "patterns":["ict√®re", "prurit", "jaune"], "answer":"Oui j'ai bien l'impression d'√™tre jaune depuis quelques jours." },
            { "id": "q_masseabdo_8", "patterns":["alt√©ration de l'√©tat g√©n√©ral", "AEG", "fatigu√©", "fatigue"], "answer":"Non pas tellement, j'ai juste perdu du poids." },
            { "id": "q_masseabdo_9", "patterns":["localisation", "taille", "consistance"], "answer":"La palpation retrouve une masse dure √©pigastrique." },
            { "id": "q_masseabdo_10", "patterns":["douleur", "douleur √† la palpation"], "answer":"Douleur d√©clench√©e √† la palpation. Le patient d√©crit √©galement une irradiation dans le dos." },
            { "id": "q_masseabdo_11", "patterns":["orifices herniaires"], "answer":"Orifices herniaires libres." },
            { "id": "q_masseabdo_12", "patterns":["bonjour"], "answer":"Bonjour Docteur, je viens car j'ai une boule dans le ventre, vous pouvez regarder √ßa, je suis super angoiss√©." },
            { "id": "q_masseabdo_13", "patterns":["palaption abdominale", "quadrants", "d√©fense", "contracture"], "answer":"Masse dure √©pigastrique avec douleur d√©clench√©e." },
            { "id": "q_masseabdo_14", "patterns":["silence", "silence auscultatoire", "gaz", "auscultation abdominale"], "answer":"BHA retrouv√©s." },
            { "id": "q_masseabdo_15", "patterns":["touchers pelviens", "toucher rectal"], "answer":"Absence d'anomalies aux touchers pelviens." },
            { "id": "q_masseabdo_16", "patterns":["ascite"], "answer":"Absence d'ascite." },
            { "id": "q_masseabdo_17", "patterns":["ant√©c√©dents", "traitement", "traitements", "allergie"], "answer":"Aucun ant√©c√©dent, aucun traitement et pas d'allergies, habituellement tout va bien." },
            { "id": "q_masseabdo_18", "patterns":["inspection abdominale"], "answer":"Pas de cicatrices pr√©sence d'un ict√®re." }
          ]
        },

        {
          id: "SDD7",
          title: "Masse ou tum√©faction pari√©tale",
          intro: "Vous √™tes gastro-ent√©rologue et vous recevez en consultation un patient de 26 ans qui vient apr√®s la d√©couverte d'une tum√©faction en bas de l'abdomen. R√©alisez l'examen clinique et l'interrogatoire, donnez un diagnostic pr√©cis et expliquez au patient la CAT en terme d'examens compl√©mentaires et de PEC.",
          recap: [
            "Il faut savoir diff√©rencier les diff√©rents types d'hernies.",
            "Une hernie symptomatique donne une douleur ou g√™ne major√©e √† la toux et √† la station debout, la hernie reste impulsive et r√©ductible.",
            "Une hernie engou√©e est irr√©ductible qu'elle soit douloureuse ou non, son risque est l'√©volution vers la hernie √©trangl√©e.",
            "La hernie √©trangl√©e est douloureuse, irr√©ductible et non impulsive √† la toux. Son √©volution est rapide vers un syndrome occlusif."
          ],

          questionSet: [
            { "id": "q_massepar_1", "patterns":["inspection abdominale", "hernie", "cicatrices"], "answer":"Ca fait quelques semaines que j'ai cette boule au niveau de l'estomac."},
            { "id": "q_massepar_2", "patterns":["debout", "toussez", "tousser"], "answer":"Majoration de la tum√©faction √† la position debout et √† la toux." },
            { "id": "q_massepar_3", "patterns":["r√©duire", "r√©duction"], "answer":"La tum√©faction est r√©ductible sans douleur." },
            { "id": "q_massepar_4", "patterns":["hernie controlat√©rale", "autre c√¥t√©"], "answer":"Absence d'hernie controlat√©rale." },
            { "id": "q_massepar_5", "patterns":["douleur", "douloureux", "douloureuse"], "answer":"Je n'ai pas mal du tout et je n'ai pas eu d'√©pisodes douloureux depuis qu'elle est apparue." },
            { "id": "q_massepar_6", "patterns":["vomissements", "vomi", "arr√™t des gaz", "gaz", "selles"], "answer":"Non je n'ai pas vomi, pas de naus√©es et mon transit est bon." },
            { "id": "q_massepar_7", "patterns":["hernie inguinale non compliqu√©e"], "answer":"Vous pensez donc que j'ai une hernie inguinale. Il faut faire quoi comme imagerie dans ce cas ?" },
            { "id": "q_massepar_8", "patterns":["aucun examen compl√©mentaire", "pas d'examen", "pas de scanner", "pas de radio", "pas d'imagerie"], "answer":"D'accord je comprend. Et en terme de traitement ?" },
            { "id": "q_massepar_9", "patterns":["pas de traitements", "absence de traitement"], "answer":"Ok Docteur je vous crois." },
            { "id": "q_massepar_10", "patterns":["chirurgie"], "answer":"Ok donc si j'ai mal je serais op√©r√© et quand est-ce que je dois reconsulter ?" },
            { "id": "q_massepar_11", "patterns":["consultez", "consultation"], "answer":"Ok je vois." },
            { "id": "q_massepar_12", "patterns":["contexte", "d√©couvert", "combien de temps", "d√©couverte", "anamn√®se"], "answer":"Ca fait 2 mois que j'ai aper√ßu cette boule dans l'aine." },
            { "id": "q_massepar_12", "patterns":["bonjour"], "answer":"Bonjour Docteur je viens vous voir car j'ai une boule au niveau de l'aine." },
            { "id": "q_massepar_13", "patterns":["ant√©c√©dents", "traitements", "allergie", "allergies", "tabac", "alcool", "toxiques"], "answer":"Je n'ai aucuns ant√©c√©dents et je ne prend aucun traitement. Aussi je ne fume pas, je ne bois pas et je n'ai pas d'allergies." },
            { "id": "q_massepar_14", "patterns":["autres questions", "tout compris"], "answer":"J'ai tout compris, merci beaucoup Docteur." }
          ]
        },

        {
          id: "SDD8",
          title: "M√©l√©na / rectorragies",
          intro: "Vous √™tes m√©decin de garde aux urgences et prenez en charge un patient de 56 ans qui pr√©sente des h√©mat√©m√®ses abondantes accompagn√©es de m√©l√©na. Vous √™tes accompagn√©.e de Laura infirmi√®re des urgences. A l'inspection votre patient pr√©sente des angiomes stellaires et un ict√®re. Evaluez la tol√©rance h√©modynamique du patient et expliquez √† Laura la PEC imm√©diate et √† court terme du patient.",
          recap: [
            "Le bilan biologique doit contenir : NFS, plaquettes, TP et TCA, cr√©atinin√©mie, ionogramme sanguin, groupe sanguin, gazom√©trie art√©rielle.",
            "Il faut diff√©rencier l'h√©morragie haute (au dessus de l'angle duod√©noj√©junal) de l'h√©morragie basse.",
            "Une l√©sion de l'estomac de l'oesophage ou du duod√©num peut donner des h√©mat√©m√®ses, du m√©l√©na ou des rectorragies seulement si accompagn√©s d'un choc h√©modynamique.",
            "Une l√©sion intestinale ou colique peut donner du m√©l√©na ou des rectorragies (colon G).",
            "Devant une h√©morragie digestive haute on peut penser √† : un UGD (douleur abdominale, AINS, ATCD H. pylori), des varices oesophagiennes ou gastriques (√©thylisme chronique, ATCD h√©patique, signes IHC ou HTP), une oesophagite (RGO), un sd de Mallory-Weiss (vomissements √† r√©p√©tition), un cancer de l'oesophage ou gastrique (AEG + douleur).",
            "Devant une h√©morragie digestive on peut √©voquer : des h√©morro√Ødes (constipation chronique), une diverticulose (ATCD), un cancer CR (ATCD perso ou familial de polypes ou CCR, AEG), des colites inflammatoires ou isch√©miques (ATCD), des colites infectieuses (prise ATB r√©cente, TIAC)."
          ],

          questionSet: [
            { "id": "q_melena_1", "patterns":["constantes", "param√®tres", "param√®tres vitaux"], "answer":"TA 75/50mmHg. FC 120 bpm. FR 22/mn. Sat 95% en AA. Temp√©rature 36,5¬∞C."},
            { "id": "q_melena_2", "patterns":["marbrures", "marbrure"], "answer":"Pr√©sence de marbrures aux genoux." },
            { "id": "q_melena_3", "patterns":["TRC", "temps de recoloration cutan√©e"], "answer":"TRC √† 4 secondes." },
            { "id": "q_melena_4", "patterns":["baisse temp√©rature des extr√©mit√©s", "extr√©mit√©s froides", "extr√©mit√©s"], "answer":"Extr√©mit√©s froides." },
            { "id": "q_melena_5", "patterns":["confusion", "score de glasgow"], "answer":"Patient non interrogeable." },
            { "id": "q_melena_6", "patterns":["NFS", "plaquettes", "groupe sanguin", "TP", "TCA", "ionogramme", "cr√©atinin√©mie", "gaz du sang", "gazom√©trie art√©rielle"], "answer":"Laura va piquer le patient." },
            { "id": "q_melena_7", "patterns":["unit√© de soins intensifs", "monitorer", "monitoring"], "answer":"C'est not√©." },
            { "id": "q_melena_8", "patterns":["2 voies veineuses p√©riph√©riques", "2 VVP", "deux VVP", "deux voies veineuses p√©riph√©riques"], "answer":"Laura va poser 2 VVP de bon calibre." },
            { "id": "q_melena_9", "patterns":["remplissage vasculaire", "NaCl", "NaCl 0,9%", "cristallo√Ødes"], "answer":"Laura va perfuser le patient avec du NaCl 0,9%." },
            { "id": "q_melena_10", "patterns":["transufser", "transfusion"], "answer":"Laura va pr√©venir la pharmacie." },
            { "id": "q_melena_11", "patterns":["IPP", "inhibiteurs de la pompe √† protons", "IPP en IVSE"], "answer":"Laura va mettre des IPP en IVSE." },
            { "id": "q_melena_12", "patterns":["terlipressine", "somatostatine", "ocr√©otide"], "answer":"Laura va instaurer un traitement vasoactif." },
            { "id": "q_melena_12", "patterns":["arr√™t des antiagr√©gants plaquettaires", "arr√™t des AAP", "arr√™t des anticoagulants", "anticoagulant", "anticoagulants", "AAP", "antiagr√©gants plaquettaires", "antiagr√©gant plaquettaire", "anti agr√©gant plaquettaire", "anti agr√©gants plaquettaires"], "answer": "Vous allez v√©rifier les traitements du patient et s'il a une antiagr√©gation plaquettaire ou un anticoagulant vous arr√™terez sa prescription." },
            { "id": "q_melena_13", "patterns":["antibioprophylaxie", "antibiotiques", "C3G", "c√©phalosporines"], "answer":"Des C3G seront donn√©es en prophylaxie de l'infection du liquide d'ascite." },
            { "id": "q_melena_14", "patterns":["h√©moglobine", "h√©moglobin√©mie capillaire"], "answer":"L'h√©moglobin√©mie capillaire est √† 8 g/dL." },
            { "id": "q_melena_15", "patterns":["fibroscopie", "fibroscopie oesogastroduod√©nale"], "answer":"L'√©quipe de gastroent√©rologie est pr√©venue." }
          ]
        },

        {
          id: "SDD9",
          title: "Amaigrissement",
          intro: "Vous √™tes m√©decin g√©n√©raliste et recevez une patiente de 35 ans inqui√®te √† propos d'un amaigrissement de 10 kg. Vous cherchez √† l'interrogatoire et √† l'examen clinique des signes de d√©nutrition et de carences et d√©terminez le m√©canisme en cause.",
          recap: [
            "Il y a plusieurs m√©canismes d'amaigrissement √† conna√Ætre:",
            "La diminution des ingestas.",
            "La malabsorption : maladie coeliaque, Crohn, pancr√©atite chronique, cholestase. Et la maldigestion : insuffisance pancr√©atite, gr√™le court.",
            "Augmentation des d√©penses",
            "Pertes caloriques / prot√©iques : sd n√©phrotique, ent√©ropathie exsudative, l√©sions cutan√©es.",
            "Il y a plusieurs causes d'amaigrissement √† conna√Ætre: ",
            "Organiques",
            "Psychiatriques : baisse de singesta +/- augmentation de l'activit√© physique et manoeuvres de purge",
            "Socio environnementales : difficult√© d'acc√®s aux aliments ou n√©gligence",
            "Iatrog√®ne : diminution de l'app√©tit. La polym√©dication √©tant aussi une cause d'amaigrissement du sujet √¢g√© notamment."
          ],

          questionSet: [
            { "id": "q_maigre_1", "patterns":["baisse de vision nocturne"], "answer":"Non je vois correctement m√™me la nuit."},
            { "id": "q_maigre_2", "patterns":["fracture", "traumatisme basse √©nergie"], "answer":"Je me cogne de temps en temps mais je ne me suis rien cass√© !" },
            { "id": "q_maigre_3", "patterns":["h√©matomes", "h√©marthrose", "h√©marthroses", "h√©matome", "des bleus"], "answer":"Ah √ßa oui des h√©matomes j'en ai. D√®s que je me cogne je fais des bleus super facilement. Et notamment il y a deux semaines je me suis cogn√©e le genou et il y a gonfl√© √©norm√©ment pour un tout petit choc." },
            { "id": "q_maigre_4", "patterns":["purpura p√©t√©chial", "saignement gingival", "saignement des gencives", "d√©chaussement dentaire", "perte de dents"], "answer":"Non je n'ai rien de tout √ßa." },
            { "id": "q_maigre_5", "patterns":["dyspn√©e", "difficul√© √† respirer", "palpitations", "asth√©nie", "fatigue", "fatigu√©e", "dysphagie", "difficult√© √† avaler", "p√¢leur", "p√¢le", "koilonychie", "ongles incurv√©s", "cheveux cassants", "perte de cheveux", "alop√©cie", "glossite"], "answer":"Non, par contre je n'ai plus eu de r√®gles depuis 3 mois et je ne suis pas enceinte car je n'ai pas eu de relations sexuelles depuis plus de 12 mois." },
            { "id": "q_maigre_6", "patterns":["oed√®mes des membres inf√©rieurs", "OMI"], "answer":"Non je n'ai pas d'oed√®me des membres inf√©rieurs." },
            { "id": "q_maigre_7", "patterns":["d√©ficit musculaire", "manoeuvre de Barr√©", "Barr√©", "Mangazzini", "Mangazini"], "answer":"Mon tonus musculaire est normal." },
            { "id": "q_maigre_8", "patterns":["diminution des apports", "mangez moins"], "answer":"Je mange normalement." },
            { "id": "q_maigre_9", "patterns":["diarrh√©e", "diarrh√©es", "selles graisseuses", "selles beiges", "selles claires", "douleurs abdominales", "mal au ventre"], "answer":"Oui maintenant que vous le dites, j'ai oubli√© de vous le dire mais je fais effectivement des diarrh√©es plusieurs fois par jour et elle sont plut√¥t graisseuses." },
            { "id": "q_maigre_10", "patterns":["bonjour"], "answer":"Bonjour Docteur, je viens vous voir car j'ai perdu 10 kilos et √ßa m'angoisse √©norm√©ment." },
            { "id": "q_maigre_11", "patterns":["contexte", "combien de temps"], "answer":"J'ai perdu ces 10 kilos en 6 mois alors que mon poids de base est de 40 kg." },
            { "id": "q_maigre_12", "patterns":["ant√©c√©dents", "traitements", "allergie", "allergies", "tabac", "alcool", "toxiques"], "answer":"Je n'ai jamais √©t√© vraiment malade donc je ne prend pas de traitement. En plus de √ßa j'ai un train de vie sain donc pas d'alcool, pas de tabac et pas de toxiques autre." }
          ]
        },

        {
          id: "SDD10",
          title: "Ict√®re",
          intro: "Vous √™tes m√©decin g√©n√©raliste et recevez une patiente de 65 ans qui trouve que sa couleur de peau vire au jaune depuis 2 mois. Compl√©tez l'interrogatoire et l'examen clinique notamment √† la recherche de signes permettant de distinguer un ict√®re √† bilirubine libre d'un ict√®re √† bilirubine conjugu√©e. Prescrivez et interpr√©tez un bilan biologique pour d√©terminer la nature de l'ict√®re. Poursuivez les investigations avec l'examen compl√©mentaire n√©cessaire.",
          recap: [
            "Le premier bilan permet de distinguer l'ict√®re √† bilirubine libre (>70% de la totale), l'ict√®re √† bilirubine conjugu√©e (augmentation significative des GGT et PAL) et l'ict√®re mixte (√©l√©vation des deux bilirubines sans √©l√©vation significative des PAL).",
            "Devant un IBNC : si tout est normal on pense √† un sd de Gilbert, si on a une an√©mie on lance un bilan d'h√©molyse et on prend un avis h√©matologique.",
            "Devant un ict√®re mixte la cause la plus fr√©quente est l'insuffisance h√©patoellulaire. On fait donc un bilan : TP, FV, albumine et un bilan d'h√©patite aigue. Chez le cirrhotique on cherche des facteurs aggravants.",
            "Devant un IBC on doit faire une √©chographie abdominale pour chercher une dilatation des voies biliaires.",
            "Si elles sont dilat√©es : on identifie le site de l'obstruction, on recherche un cancer de la t√™te du pancr√©as / cholangiocarcinome / lithiase VBP / compression extrins√®que. On peut faire un scanner, une bili IRM, une IRM h√©patique, une √©choendoscopie voire une CPRE suivant la cause.",
            "Si elles ne sont pas dilat√©es on recherche une cholangite scl√©rosante primitive par cholangioIRM ou une cirrhose biliaire primitive (Ac anti mitochondrie). Si on ne trouve pas d'√©tiologie on pourra proposer une PBH."
          ],

          questionSet: [
            { "id": "q_ictere_1", "patterns":["urines fonc√©es"], "answer":"Oui mes urines sont fonc√©es."},
            { "id": "q_ictere_2", "patterns":["selles d√©color√©es", "selles claires", "selles p√¢les"], "answer":"Oui mes selles sont claires." },
            { "id": "q_ictere_3", "patterns":["prurit", "gratte", "grattez"], "answer":"Je ne me gratte pas non." },
            { "id": "q_ictere_4", "patterns":["alt√©ration de l'√©tat g√©n√©ral", "AEG", "anorexie", "perte de poids", "amaigrissement", "fatigue", "asth√©nie"], "answer":"J'ai perdu 5 kilos en 4 mois et je suis clairement plus fatigu√©e qu'avant. Je mange moins aussi c'est vrai." },
            { "id": "q_ictere_5", "patterns":["douleurs abdominales"], "answer":"Oui j'ai masse en haut √† droite du ventre." },
            { "id": "q_ictere_6", "patterns":["palpation abdominale", "grosse v√©sicule"], "answer":"Une masse est palpable en hypochondre droit." },
            { "id": "q_ictere_7", "patterns":["bilan biologique", "bilirubin√©mie totale", "bilirubin√©mie conjugu√©e", "ASAT", "ALAT", "transaminases", "gamma GT", "GGT", "PAL", "phosphatases alcalines", "NFS", "plaquettes"], "answer":"Bilirubine totale 90umol/L. Bilirubine conjugu√©e 80umol/L. Bilirubine libre 10 umol/L. ASAT/ALAT 30 UI/L. GGT 120 (N<40). PAL 181 (N<120). H√©moglobine 12,5 g/dL. Plaquettes 300 G/L. Reste de la NFS sans anomalies." },
            { "id": "q_ictere_8", "patterns":["pas de cytolyse h√©patique"], "answer":"Not√©." },
            { "id": "q_ictere_9", "patterns":["cholestase"], "answer":"Not√©." },
            { "id": "q_ictere_10", "patterns":["pas d'h√©molyse", "pas d'an√©mie"], "answer":"Not√©." },
            { "id": "q_ictere_11", "patterns":["ict√®re √† bilirubine conjugu√©e"], "answer":"Le diagnostic retenu est ict√®re √† bilirubine conjugu√©e." },
            { "id": "q_ictere_12", "patterns":["√©chographie abdominale", "√©cho abdo", "√©cho-doppler abdominal"], "answer":"Une √©chographie abdominale est prescrite." },
            { "id": "q_ictere_13", "patterns":["Bonjour"], "answer":"Bonjour Docteur, je viens vous voir car je trouve que je suis de plus en plus jaune de peau depuis 2 mois. Il faut savoir que je ne suis jamais malade, je ne prend m√™me pas de traitements. Je mange sainement et je ne fume ou bois pas." }
          ]
        },

        {
          id: "SDD11",
          title: "Traumatisme abdomino-pelvien",
          intro: "Vous √™tes m√©decin de garde aux urgences et vous prenez en charge un patient de 32 ans Mr FERNANDES pour un AVP survenu √† moto. Le patient est amen√© par les SP en choc h√©modynamique, en cours de stabilisation, vous avez r√©alis√© une √©chographie abdominale, une radiographie thoracique et une radio du bassin. Le patient a re√ßu du NaCl 0,9%, 3 CGR et de la noradr√©naline. Ce bilan a retrouv√© une rupture de la rate avec h√©mop√©ritoine indiquant une PEC chirurgicale urgente. Le patient est PEC au bloc op√©ratoire, sa femme est install√© dans un box de consultation pour r√©aliser l'annonce. Annoncez la PEC et le pronostic √† la femme du patient et r√©pondez √† ses questions.",
          recap: [
            "Il faut se souvenir de la physiopathologie des atteintes des organes abdominaux apr√®s un traumatisme.",
            "Traumatisme h√©patique : trauma ferm√© / plaie hypochondre D ou h√©mithorax D / fractures derni√®res c√¥tes. Si h√©mop√©ritoine : instabilit√© + √©panchement. Si trauma + signes angiocholite : h√©mobilie. Sur la bio on retrouve une an√©mie aigue et une cytolyse h√©patique. Au scanner on peut voir un h√©matome sous capsulaire, une fracture h√©patique, une contusion ou des l√©sions vasculaires.",
            "L√©sions pancr√©atiques : compression du pancr√©as, chutes √† v√©lo, trauma par le volant. Douleurs solaires, abdomen chirurgical. Bio avec √©l√©vation de la lipase, √©l√©vation de l'amylase. Scanner : fractures, l√©sions de contusions.",
            "L√©sions de la rate : trauma ferm√©, fractures des derni√®res c√¥tes G, plaie hypochondre G, plaie thoracique du c√¥t√© G. H√©mop√©ritoine. An√©mie aigue sur la biologie sanguine. Bilan h√©patique instable, radio tho et √©cho FAST possible. Scanner : h√©matome sous capsulaire, contusion, l√©sions vasculaires du hile.",
            "Examens compl√©mentaires : FAST √©cho d√®s l'arriv√©e, recherche d'h√©mop√©ritoine, si h√©mop√©ritoine traumatisme grave de la rate et/ou du foie. Puis si possible r√©alisation d'un scanner",
            "Si traumatisme h√©patique : traitement m√©dical h√©modynamique, sinon laparotomie d'h√©mostase",
            "Si traumatisme pancr√©atique : traitement m√©dical de la pancr√©atite aigue, traitement chir si plaie par arme blanche ou √† feu / instabilit√© HD / l√©sions canalaires",
            "Si traumatisme spl√©nique : traitement m√©dical si patient stable +/- embolisation art√©rielle spl√©nique, sinon spl√©nectomie. Rappel : vaccin pneumocoque, haemophilus, m√©ningocoque et grippe + ATB prophylaxie dans les suites.",
            "Si h√©matome r√©trop√©riton√©ale : traitement m√©dical avec ceinture pelvienne si suspi de fracture du bassin. Art√©rioembolisation si fracture du bassin. Ttt chirurgical : bride ant√©rieure ou clamp pelvien, si √©chec packing pelvien."

          ],

          questionSet: [
            { "id": "q_traumabdo_1", "patterns":["bonjour"], "answer":"Bonjour Docteur, je suis bien Mme FERNANDES. Merci de me recevoir pour discuter de mon conjoint. J'ai appris qu'il avait eu un accident de moto. On m'a dit qu'il √©tait au bloc op√©ratoire, je peux savoir pourquoi ?"},
            { "id": "q_traumabdo_2", "patterns":["bloc op√©ratoire", "op√©r√©", "en salle d'op√©ration"], "answer":"Donc l√† des chirurgiens l'op√®rent car il saigne mais pourquoi saigne t'il ? " },
            { "id": "q_traumabdo_3", "patterns":["rate", "saignement spl√©nique", "saigne de la rate", "sa rate saigne", "rupture de rate", "rupture spl√©nique"], "answer":"Ok donc je comprend qu'il a eu une rupture de rate. On lui a donn√© quoi comme traitement avant le bloc ?" },
            { "id": "q_traumabdo_4", "patterns":["remplissage", "NaCl", "transufsion", "noradr√©naline"], "answer":"D'accord donc il a perdu beaucoup de sang et n'√©tait pas stable. Qu'est-ce qui fait qu'on pouvait pas attendre pour faire cette chirurgie ?" },
            { "id": "q_traumabdo_5", "patterns":["pertes sanguines", "instable", "instabilit√©"], "answer":"Il √©tait instable d'accord. Et apr√®s cette op√©ration c'est fini ? A quoi elle sert exactement ?" },
            { "id": "q_traumabdo_6", "patterns":["arr√™ter le saignement", "autre op√©ration", "damage control"], "answer":"Je vois donc c'est pour faire pansement en gros. Elle sera longue cette op√©ration ?" },
            { "id": "q_traumabdo_7", "patterns":["courte", "rapide"], "answer":"D'accord donc plut√¥t rapide. Et il est endormi ?" },
            { "id": "q_traumabdo_8", "patterns":["anesth√©sie g√©n√©rale"], "answer":"D'accord. Ensuite il rentre √† la maison ?" },
            { "id": "q_traumabdo_9", "patterns":["hospitalis√©", "soins intensifs"], "answer":"Oh je vois. C'est pas rassurant tout √ßa. Et il s'en sortira l√† c'est sur ?" },
            { "id": "q_traumabdo_10", "patterns":["d√©c√®s"], "answer":"Il peut d√©c√©der ? Oh mon dieu... Je ne sais pas quoi vous dire... Il va garder sa rate s'il survit" },
            { "id": "q_traumabdo_11", "patterns":["spl√©nectomie"], "answer":"Ah on pourrait lui enlever la rate... Bon et s'il se sort de tout √ßa il aura des traitements pendant un certain temps j'imagine ?" },
            { "id": "q_traumabdo_12", "patterns":["infection", "infectieux", "vaccins", "vaccinations", "antibiotiques", "antibioprophylaxie"], "answer":"D'accord donc il devra bien √™tre √† jour de ses vaccins et prendre un antibiotique. " },
            { "id": "q_traumabdo_13", "patterns":["autres questions", "tout compris", "compris"], "answer":"J'ai compris ce que vous me dites Docteur, merci pour toutes ses informations." }
          ]
        }
      ]
    }
  ],
  botBehavior: { fallbackAnswer: "Je ne sais pas." }
};

// ===== VARIABLES =====
let currentChapter = null;
let questionsAsked = new Set();
let botQueue = [];
let botIsTyping = false;

const messages = document.getElementById("messages");
const input = document.getElementById("input");
const finishBtn = document.getElementById("finishBtn");

// ===== UTILS =====
function normalizeText(text){
  return text.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();
}

// ===== BOT QUEUE + TYPING =====
function botSay(text){
  botQueue.push(text);
  if (!botIsTyping) processBotQueue();
}

function processBotQueue(){
  if (botQueue.length === 0) {
    botIsTyping = false;
    return;
  }

  botIsTyping = true;
  const text = botQueue.shift();

  if (typeof text === "function") {
    text();
    processBotQueue();
    return;
  }

  const container = document.createElement("div");
  container.className = "bot-container";

  const avatar = document.createElement("div");
  avatar.className = "bot-avatar";
  avatar.textContent = "ü§ñ";

  const bubble = document.createElement("div");
  bubble.className = "bot thinking";
  bubble.textContent = "r√©fl√©chit";

  container.appendChild(avatar);
  container.appendChild(bubble);
  messages.appendChild(container);
  messages.scrollTop = messages.scrollHeight;

  let dots = 0;
  const thinkingInterval = setInterval(() => {
    dots = (dots + 1) % 4;
    bubble.textContent = "r√©fl√©chit" + ".".repeat(dots);
  }, 400);

  setTimeout(() => {
    clearInterval(thinkingInterval);
    bubble.className = "bot";
    bubble.textContent = "";

    let i = 0;
    const speed = 20;
    const typingInterval = setInterval(() => {
      bubble.textContent += text.charAt(i);
      i++;
      messages.scrollTop = messages.scrollHeight;

      if (i >= text.length) {
        clearInterval(typingInterval);
        processBotQueue();
      }
    }, speed);
  }, 800);
}

function userSay(text){
  const div = document.createElement("div");
  div.className = "user";
  div.textContent = text;
  messages.appendChild(div);
  messages.scrollTop = messages.scrollHeight;
}

// ===== THEMES =====
function showThemes(isInitial = false){
  if(isInitial){
    botSay("Bienvenue üëã Choisis une sp√©cialit√© :");
  }
  const wrapper = document.createElement("div");
  wrapper.className = "choices";

  data.themes.forEach(theme=>{
    const btn = document.createElement("button");
    btn.textContent = theme.title;
    btn.onclick = () => selectTheme(theme);
    wrapper.appendChild(btn);
  });

  messages.appendChild(wrapper);
}

function selectTheme(theme){
  document.querySelectorAll(".choices").forEach(e => e.remove());

  const chapters = theme.chapters;
  currentChapter = chapters[Math.floor(Math.random() * chapters.length)];

  questionsAsked.clear();
  botSay(`üìò ${currentChapter.title}`);
  botSay(currentChapter.intro);
  finishBtn.disabled = false;
}


// ===== CHAT =====
function send(){
  if(!currentChapter) return;
  let text = input.value.trim();
  if(!text) return;

  userSay(text);
  input.value = "";

  const normalized = normalizeText(text);
  let matched = false;

  currentChapter.questionSet.forEach(q => {
    if (matched) return; // une seule r√©ponse
    q.patterns.forEach(p => {
      if(normalized.includes(normalizeText(p))){
        botSay(q.answer);
        questionsAsked.add(q.id);
        matched = true;
      }
    });
  });

  if(!matched) botSay(data.botBehavior.fallbackAnswer);
}

// ===== FIN =====
function calculateScore(){
  if(!currentChapter) return;

  botSay("üìä Fin de la consultation");
  botSay(`Questions abord√©es : ${questionsAsked.size} / ${currentChapter.questionSet.length}`);
  botSay("üìù R√©capitulatif :");

  (currentChapter.recap || []).forEach(msg => botSay(msg));

  botSay("‚ú® Consultation termin√©e. Choisis une nouvelle sp√©cialit√© ci-dessous :");

  botQueue.push(() => {
      currentChapter = null;
      questionsAsked.clear();
      finishBtn.disabled = true;
      showThemes();
  });
}

// ===== START =====
showThemes(true);
</script>

</body>
</html>
